var PImage = require('../src/pureimage');
var fs = require('fs');

var fnt = PImage.registerFont('tests/fonts/pixel_maz.ttf','Source Sans Pro');

fnt.load(function() {
    var img = PImage.make(384,128);
    var ctx = img.getContext('2d');
    ctx.fillStyle = "#ffffff";
    ctx.fillRect(0,0,384,128);
    ctx.setFont('Source Sans Pro',13);
    ctx.fillStyle = '#000000';

    ctx.USE_FONT_GLYPH_CACHING = false;
    var before = process.hrtime();
    var str = "Incinerated the monster";
    ctx.fillText(str,30,30);

    PImage.encodePNG(img, fs.createWriteStream('text.png'), function(err) {
        console.log("wrote out the png file to build/text.png");
    });
});
